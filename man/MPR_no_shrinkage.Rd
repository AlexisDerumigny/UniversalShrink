% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MPR_no_shrinkage.R
\name{MPR_no_shrinkage}
\alias{MPR_no_shrinkage}
\title{Moore-Penrose-Ridge}
\usage{
MPR_no_shrinkage(X, centeredCov = TRUE, t, verbose = 0)
}
\arguments{
\item{X}{data matrix (rows are observations, columns are features).}

\item{centeredCov}{Boolean variable. If \code{TRUE}, the covariance matrix is
computed using centering (i.e. in the general case where the mean of the
random vector may be non-zero).
If \code{FALSE} the covariance matrix is computed assuming that the mean of
the random vector of interest is \code{0} (i.e. does not need to be estimated).}

\item{t}{parameter of the estimation.}

\item{verbose}{a number indicating whether to print intermediary values and
details about the progress of the computations. A value of \code{0} indicates
no printing at all, while higher values indicate increasingly more detailed
(more verbose) output.}
}
\value{
the estimator of the precision matrix, of class
\code{EstimatedPrecisionMatrix}.
}
\description{
This function computes Moore-Penrose-ridge inverse (see, Bodnar and Parolya (2026))
\deqn{
\mathbf{S}_n^{\pm}(t)
=
(\mathbf{S}_n + t \mathbf{I}_p)^{-1}
-
t (\mathbf{S}_n + t \mathbf{I}_p)^{-2}
}
where \eqn{\mathbf{S}_n} is the sample covariance matrix and \eqn{t>0}
is a given parameter. By specifying \code{centeredCov=TRUE} (by default) one
can choose between centered and noncentered versions of the sample covariance matrix.
}
\examples{

n = 10
p = 5 * n
mu = rep(0, p)

# Generate Sigma
X0 <- MASS::mvrnorm(n = 10*p, mu = mu, Sigma = diag(p))
H <- eigen(t(X0) \%*\% X0)$vectors
Sigma = H \%*\% diag(seq(1, 0.02, length.out = p)) \%*\% t(H)

# Generate example dataset
X <- MASS::mvrnorm(n = n, mu = mu, Sigma = Sigma)

Ip = diag(nrow = p)
for (t in c(0.01, 0.2, 0.5, 1, 2)){
  precision_MPR_Cent = MPR_no_shrinkage(X, centeredCov = TRUE, t = t)
  
  Jn <- diag(n) - matrix(1/n, nrow = n, ncol = n)
  S = t(X) \%*\% Jn \%*\% X / (n-1)
  precision_ridge = solve(S + t * Ip)
  precision_MPR_Cent_alternative_expression = precision_ridge \%*\% S \%*\% precision_ridge
  precision_MP = Moore_Penrose(X, centeredCov = TRUE)

  cat("t = ", t,", Moore-Penrose  , loss =", 
    FrobeniusLoss2(precision_MP, Sigma = Sigma, type = "precision"), "\n")
  cat("t = ", t,", ridge          , loss =", 
    FrobeniusLoss2(precision_ridge, Sigma = Sigma, type = "precision"), "\n")
  cat("t = ", t,", MPR            , loss =", 
    FrobeniusLoss2(precision_MPR_Cent, Sigma = Sigma, type = "precision"), "\n")
  cat("t = ", t,", MPR alternative, loss =", 
    FrobeniusLoss2(precision_MPR_Cent_alternative_expression, Sigma = Sigma,
                   type = "precision"), "\n")
}


}
\references{
Nestor Parolya & Taras Bodnar (2026).
Reviving pseudo-inverses: Asymptotic properties of large dimensional
Moore-Penrose and Ridge-type inverses with applications.
\doi{10.48550/arXiv.2403.15792}
}
