% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cov_analytical_NL_shrinkage.R
\name{cov_analytical_NL_shrinkage}
\alias{cov_analytical_NL_shrinkage}
\title{Analytical non-linear shrinkage from Ledoit and Wolf (2020)}
\usage{
cov_analytical_NL_shrinkage(X, centeredCov = TRUE)
}
\arguments{
\item{X}{data matrix (rows are observations, columns are features).}

\item{centeredCov}{Boolean variable. If \code{TRUE}, the covariance matrix is
computed using centering (i.e. in the general case where the mean of the
random vector may be non-zero).
If \code{FALSE} the covariance matrix is computed assuming that the mean of
the random vector of interest is \code{0} (i.e. does not need to be estimated).}
}
\value{
the estimator of the covariance matrix
(a \code{p} by \code{p} matrix).
TODO: update this
}
\description{
This function estimates the covariance matrix as a given data set using
classical nonlinear shrinkage from Ledoit and Wolf (2020).
}
\details{
For \eqn{i\in\{1,\ldots,p\}}, the nonlinear shrinkage estimator of
Ledoit and Wolf is given by
\deqn{
\mathbf{S}_{NLSh}= \mathbf{U} \text{diag}(d_1^{or},...,d_p^{or})
\mathbf{U}^\top, \quad d_i^{or}=\left\{
 \begin{array}{ll}
 \frac{d_i}{|1-c-c d_i \breve{m}_{F}(d_i)|^2},    & \text{if}~~ d_i>0,\\
 \frac{1}{(c-1)\breve{m}_{\underline{F}}(0)}, & \text{if}~~ d_i=0,
 \end{array}
 \right.
 }
where \eqn{\mathbf{U}=(\mathbf{u}_1,...\mathbf{u}_p)} is the matrix with the
sample eigenvectors of \eqn{\mathbf{S}_n}, \eqn{d_i}, \eqn{i=1,\ldots,} are
the sample eigenvalues of \eqn{\mathbf{S}_n} and
\eqn{\breve{m}_{F}(x)=\lim\limits_{z\to x}m_{F}(z)} with \eqn{m_{F}(z)} the
limiting Stieltjes transform of the sample covariance matrix. A numerical
approach to estimate \eqn{\breve{m}_{F}(x)} is provided in Ledoit and Wolf
(2020) and is available in the R-package \eqn{\textit{HDShOP}}.
}
\examples{
p = 200
Sigma = diag(seq(1, 0.02, length.out = p))
mu = rep(0, p)
X <- MASS::mvrnorm(n = 100, mu = mu, Sigma=Sigma)
estimatedCov_sample = cov(X)
estimatedCov_shrink = cov_analytical_NL_shrinkage(X)

# We now compare the distance between the true and both estimators.
FrobeniusLoss2(estimatedCov_sample, Sigma, type = "covariance")
FrobeniusLoss2(estimatedCov_shrink, Sigma)

LossEuclideanEigenvalues2(estimatedCov_sample, Sigma, type = "covariance")
LossEuclideanEigenvalues2(estimatedCov_shrink, Sigma)

}
\references{
Ledoit, O., & Wolf, M. (2020).
Analytical nonlinear shrinkage of large-dimensional covariance matrices.
The Annals of Statistics, 48(5), 3043-3065.
\doi{10.1214/19-AOS1921}

Bodnar, T., S. Dmytriv, Y. Okhrin, D. Otryakhin, & N. Parolya. 2024. HDShOP:
High-Dimensional Shrinkage Optimal Portfolios.
R package version 0.1.7. \doi{10.32614/CRAN.package.HDShOP}
}
