% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ridge_higher_order_shrinkage.R,
%   R/ridge_higher_order_shrinkage_optimal.R
\name{ridge_higher_order_shrinkage}
\alias{ridge_higher_order_shrinkage}
\alias{ridge_higher_order_shrinkage_optimal}
\title{Ridge higher order shrinkage}
\usage{
ridge_higher_order_shrinkage(Y, m, centeredCov, t, verbose = 0)

ridge_higher_order_shrinkage_optimal(
  Y,
  m,
  centeredCov,
  interval = c(0, 50),
  verbose = 0
)
}
\arguments{
\item{Y}{data matrix (rows are features, columns are observations).
TODO: transpose everything.}

\item{m}{order of the shrinkage. Should be at least 1.}

\item{centeredCov}{Boolean variable. If \code{TRUE}, the covariance matrix is
computed using centering (i.e. in the general case where the mean of the
random vector may be non-zero).
If \code{FALSE} the covariance matrix is computed assuming that the mean of
the random vector of interest is \code{0} (i.e. does not need to be estimated).}

\item{t}{penalization parameter}

\item{verbose}{a number indicating whether to print intermediary values and
details about the progress of the computations. A value of \code{0} indicates
no printing at all, while higher values indicate increasingly more detailed
(more verbose) output.}
}
\description{
Ridge higher order shrinkage
}
\examples{

n = 10
p = 2 * n
mu = rep(0, p)

# Generate Sigma
X0 <- MASS::mvrnorm(n = 10*p, mu = mu, Sigma = diag(p))
H <- eigen(t(X0) \%*\% X0)$vectors
Sigma = H \%*\% diag(seq(1, 0.02, length.out = p)) \%*\% t(H)

# Generate example dataset
X <- MASS::mvrnorm(n = n, mu = mu, Sigma=Sigma)

precision_MoorePenrose_Cent = Moore_Penrose_shrinkage(Y = t(X), centeredCov = TRUE)
precision_MoorePenrose_NoCent = Moore_Penrose_shrinkage(Y = t(X), centeredCov = FALSE)

FrobeniusLoss2(precision_MoorePenrose_Cent, Sigma = Sigma)
FrobeniusLoss2(precision_MoorePenrose_NoCent, Sigma = Sigma)

for (m in 1:2){
  cat("m = ", m, "\n")
  precision_higher_order_shrinkage_Cent = 
      ridge_higher_order_shrinkage(Y = t(X), m = m, centeredCov = TRUE, t = 10)
      
  precision_higher_order_shrinkage_NoCent = 
      ridge_higher_order_shrinkage(Y = t(X), m = m, centeredCov = FALSE, t = 10)
      
  print(FrobeniusLoss2(precision_higher_order_shrinkage_Cent, Sigma = Sigma))
  
  print(FrobeniusLoss2(precision_higher_order_shrinkage_NoCent, Sigma = Sigma))
}


precision_higher_order_shrinkage_Cent = 
  ridge_higher_order_shrinkage(Y = t(X), m = 1, centeredCov = TRUE, t = 100)

precision_target_identity_semioptimal_Cent = 
  ridge_target_identity_semioptimal(Y = t(X), centeredCov = TRUE, t = 100)
      
precision_target_general_semioptimal_Cent = 
  ridge_target_general_semioptimal(Y = t(X), centeredCov = TRUE, t = 100, Pi0 = diag(p))

precision_higher_order_shrinkage_Cent$alpha
precision_target_identity_semioptimal_Cent$beta_optimal
precision_target_identity_semioptimal_Cent$alpha_optimal

precision_target_general_semioptimal_Cent$beta_optimal
precision_target_general_semioptimal_Cent$alpha_optimal

precision_higher_order_shrinkage_Cent$M
precision_target_identity_semioptimal_Cent$M

precision_higher_order_shrinkage_Cent$hm
precision_target_identity_semioptimal_Cent$hm

FrobeniusLoss2(precision_higher_order_shrinkage_Cent, Sigma = Sigma)
FrobeniusLoss2(precision_target_identity_semioptimal_Cent, Sigma = Sigma)


# Examples for `ridge_higher_order_shrinkage_optimal`

for (m in 1:2){
  cat("m = ", m, "\n")
  precision_higher_order_shrinkage_Cent = 
      ridge_higher_order_shrinkage_optimal(Y = t(X), m = m, centeredCov = TRUE)
      
  precision_higher_order_shrinkage_NoCent = 
      ridge_higher_order_shrinkage_optimal(Y = t(X), m = m, centeredCov = FALSE)
      
  print(FrobeniusLoss2(precision_higher_order_shrinkage_Cent, Sigma = Sigma))
  
  print(FrobeniusLoss2(precision_higher_order_shrinkage_NoCent, Sigma = Sigma))
}

precision_higher_order_shrinkage_Cent = 
      ridge_higher_order_shrinkage_optimal(Y = t(X), m = 1, centeredCov = TRUE)

precision_ridge_target_Cent = 
    ridge_target_identity_optimal(Y = t(X), centeredCov = TRUE)
  
FrobeniusLoss2(precision_higher_order_shrinkage_Cent, Sigma = Sigma)
FrobeniusLoss2(precision_ridge_target_Cent, Sigma = Sigma)



}
