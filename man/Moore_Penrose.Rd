% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Moore_Penrose.R
\name{Moore_Penrose}
\alias{Moore_Penrose}
\title{Moore-Penrose inverse of the sample covariance matrix}
\usage{
Moore_Penrose(Y, centeredCov)
}
\arguments{
\item{Y}{data matrix (rows are features, columns are observations).
TODO: transpose everything.}

\item{centeredCov}{Boolean: do we center (\code{TRUE}) or not (\code{FALSE}).}
}
\value{
the estimator of the precision matrix
(a \code{p} by \code{p} matrix, i.e. the inverse of the covariance matrix).
}
\description{
Moore-Penrose inverse of the sample covariance matrix
}
\examples{

n = 50
p = 2 * n
mu = rep(0, p)

# Generate Sigma
X0 <- MASS::mvrnorm(n = 10*p, mu = mu, Sigma = diag(p))
H <- eigen(t(X0) \%*\% X0)$vectors
Sigma = H \%*\% diag(seq(1, 0.02, length.out = p)) \%*\% t(H)

# Generate example dataset
X <- MASS::mvrnorm(n = n, mu = mu, Sigma=Sigma)

iS_MP = Moore_Penrose(Y = t(X), centeredCov = TRUE)

# Sample covariance matrix
Y = t(X)
Jn <- diag(n) - matrix(1/n, nrow = n, ncol = n)
S <- Y \%*\% Jn \%*\% t(Y) / (n-1)

# We test iS_MP \%*\% S \%*\% iS_MP == iS_MP
sum((iS_MP \%*\% S \%*\% iS_MP - iS_MP)^2)

# We test S \%*\% iS_MP \%*\% S == S
sum((S \%*\% iS_MP \%*\% S - S)^2)

# We test S \%*\% iS_MP == t(S \%*\% iS_MP)
sum((S \%*\% iS_MP - t(S \%*\% iS_MP))^2)

# We test iS_MP \%*\% S == t(iS_MP \%*\% S)
sum((iS_MP \%*\% S - t(iS_MP \%*\% S))^2)

}
\references{
Nestor Parolya & Taras Bodnar (2024).
Reviving pseudo-inverses: Asymptotic properties of large dimensional
Moore-Penrose and Ridge-type inverses with applications.
\link{https://doi.org/10.48550/arXiv.2403.15792}
}
