% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Moore_Penrose.R
\name{Moore_Penrose}
\alias{Moore_Penrose}
\title{Moore-Penrose inverse of the sample covariance matrix}
\usage{
Moore_Penrose(X, centeredCov = TRUE)
}
\arguments{
\item{X}{data matrix (rows are observations, columns are features).}

\item{centeredCov}{Boolean variable. If \code{TRUE}, the covariance matrix is
computed using centering (i.e. in the general case where the mean of the
random vector may be non-zero).
If \code{FALSE} the covariance matrix is computed assuming that the mean of
the random vector of interest is \code{0} (i.e. does not need to be estimated).}
}
\value{
the estimator of the precision matrix
(a \code{p} by \code{p} matrix, i.e. the inverse of the covariance matrix).
}
\description{
Having a centered (by default) or non-centered observation matrix
\eqn{\mathbf{X}_n} with the corresponding sample covariance matrix
\eqn{\mathbf{S}_n}. The Moore-Penrose inverse of this sample
covariance matrix, denoted by \eqn{\mathbf{S}^+_n} is computed by the following
formula
\deqn{
\mathbf{S}_n^+=\left(\frac{1}{n}\mathbf{X}_n^\top\mathbf{X}_n\right)^+
=\frac{1}{\sqrt{n}}\mathbf{X}_n^\top\left(\frac{1}{n}
\mathbf{X}_n\mathbf{X}_n^\top\right)^{-2}
\frac{1}{\sqrt{n}}\mathbf{X}_n.
} See, the beginning of the proof of Theorem 2.1 in Bodnar and Parolya (2026)
for the details how the centering was done.
}
\examples{

n = 50
p = 2 * n
mu = rep(0, p)

# Generate Sigma
X0 <- MASS::mvrnorm(n = 10*p, mu = mu, Sigma = diag(p))
H <- eigen(t(X0) \%*\% X0)$vectors
Sigma = H \%*\% diag(seq(1, 0.02, length.out = p)) \%*\% t(H)

# Generate example dataset
X <- MASS::mvrnorm(n = n, mu = mu, Sigma=Sigma)

iS_MP = Moore_Penrose(X, centeredCov = TRUE)
# Convert to matrix class for computations
iS_MP = as.matrix(iS_MP)

# Sample covariance matrix
Y = t(X)
Jn <- diag(n) - matrix(1/n, nrow = n, ncol = n)
S <- Y \%*\% Jn \%*\% t(Y) / (n-1)

# We test iS_MP \%*\% S \%*\% iS_MP == iS_MP
sum((iS_MP \%*\% S \%*\% iS_MP - iS_MP)^2)

# We test S \%*\% iS_MP \%*\% S == S
sum((S \%*\% iS_MP \%*\% S - S)^2)

# We test S \%*\% iS_MP == t(S \%*\% iS_MP)
sum((S \%*\% iS_MP - t(S \%*\% iS_MP))^2)

# We test iS_MP \%*\% S == t(iS_MP \%*\% S)
sum((iS_MP \%*\% S - t(iS_MP \%*\% S))^2)

}
\references{
Nestor Parolya & Taras Bodnar (2026).
Reviving pseudo-inverses: Asymptotic properties of large dimensional
Moore-Penrose and Ridge-type inverses with applications.
\doi{10.48550/arXiv.2403.15792}
}
