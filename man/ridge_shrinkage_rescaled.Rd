% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ridge_shrinkage_rescaled.R
\name{ridge_shrinkage_rescaled}
\alias{ridge_shrinkage_rescaled}
\title{Optimal ridge shrinkage for estimation of the precision matrix by
Wang et al. (2015)}
\usage{
ridge_shrinkage_rescaled(X, eps = 1e-06, upp = pi/2 - 1e-06)
}
\arguments{
\item{X}{data matrix (rows are observations, columns are features).}

\item{eps, upp}{search interval for the best penalization parameter
(used in the numerical optimization).}
}
\value{
the estimator of the precision matrix
(a \code{p} by \code{p} matrix, i.e. the inverse of the covariance matrix).
}
\description{
The optimal ridge estimator of
Wang et al. (2015) is given by
}
\details{
\deqn{
\widehat{\boldsymbol{\Pi}}_{OR}
=
\hat{\alpha}_{OR;n}
\left(
\mathbf{S}_n
+
\hat{\beta}_{OR;n}\mathbf{I}_p
\right)^{-1}
.}
Here,
\deqn{
\hat{\alpha}_{OR;n}
=
\frac{
\hat{R}_{1,n}(\hat{\beta}_{OR;n})
}{
\hat{R}_{2,n}(\hat{\beta}_{OR;n})
}.
}
Moreover, for \eqn{\lambda>0}
\deqn{
\hat{R}_{1,n}(\lambda)
=
\frac{
\hat{a}_{1;n}(\lambda)
}{
1 - c_n \hat{a}_{1;n}(\lambda)
},
\quad
\hat{R}_{2,n}(\lambda)
=
\frac{
\hat{a}_{1;n}(\lambda)
}{
(1 - c_n \hat{a}_{1;n}(\lambda))^3
}
-
\frac{
\hat{a}_{2;n}(\lambda)
}{
(1 - c_n \hat{a}_{1;n}(\lambda))^4
}
.}
with
\deqn{
\hat{a}_{1;n}(\lambda)
=
1
-
\frac{1}{p}
\text{\rm tr}\!\left[
\left(
\mathbf{S}_n/\lambda + \mathbf{I}_p
\right)^{-1}
\right]
}
and
\deqn{
\hat{a}_{2;n}(\lambda)
=
\frac{1}{p}
\text{\rm tr}\!\left[
\left(
\mathbf{S}_n/\lambda + \mathbf{I}_p
\right)^{-2}
\right]
.} Here \eqn{c_n=p/n} denotes the concentration ratio and
the parameter \eqn{\hat{\beta}_{OR;n}} minimizes over \eqn{\lambda>0} the
function
\deqn{
L_{OR;n}
=
1
-
\frac{
\hat{R}_{1,n}(\lambda)^2
}{
\hat{R}_{2,n}(\lambda)
}.
}
}
\examples{
p = 200
Sigma = diag(seq(1, 0.02, length.out = p))
mu = rep(0, p)
X <- MASS::mvrnorm(n = 100, mu = mu, Sigma=Sigma)
precision_OptimalRidge = ridge_shrinkage_rescaled(X)

precisionTrue = solve(Sigma)

estimatedCov_NLshrink = cov_analytical_NL_shrinkage(X)
estimatedCov_QISshrink = cov_quadratic_inverse_shrinkage(X)

precision_NLshrink = solve(estimatedCov_NLshrink)
precision_QISshrink = solve(estimatedCov_QISshrink)

FrobeniusLoss2(precision_OptimalRidge, Sigma = Sigma)
FrobeniusLoss2(precision_NLshrink, Sigma = Sigma, type = "precision matrix")
FrobeniusLoss2(precision_QISshrink, Sigma = Sigma, type = "precision matrix")


}
\references{
Wang, C., Pan, G., Tong, T., & Zhu, L. (2015).
Shrinkage estimation of large dimensional precision matrix using random matrix theory.
Statistica Sinica, 993-1008.
\doi{10.5705/ss.2012.328}
}
