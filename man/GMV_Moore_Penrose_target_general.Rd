% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GMV_Moore_Penrose_target_general.R
\name{GMV_Moore_Penrose_target_general}
\alias{GMV_Moore_Penrose_target_general}
\title{First-order shrinkage of the Moore-Penrose portfolio towards a general target portfolio}
\usage{
GMV_Moore_Penrose_target_general(Y, centeredCov = TRUE, b = NULL)
}
\arguments{
\item{Y}{data matrix (rows are features, columns are observations).
TODO: transpose everything.}

\item{b}{target portfolio. This is a vector of size \code{p} which sums to 1.
By default this is the equally weighted portfolio.}
}
\value{
a vector of size \eqn{p} of (estimated) optimal portfolio weights,
where \eqn{p} is the number of assets.
}
\description{
This function computes
\deqn{\alpha \times w_{MP} + (1 - \alpha) \times \mathbf{b}}
where \eqn{\alpha} is a carefully chosen coefficient, \eqn{w_{MP}} is the
vector of optimal portfolio weights estimated as the plug-in of the Moore-Penrose
estimate of the precision matrix and \eqn{\mathbf{b}} is the target.
}
\examples{
n = 50
p = 2 * n
mu = rep(0, p)

# Generate Sigma
X0 <- MASS::mvrnorm(n = 10*p, mu = mu, Sigma = diag(p))
H <- eigen(t(X0) \%*\% X0)$vectors
Sigma = H \%*\% diag(seq(1, 0.02, length.out = p)) \%*\% t(H)

# Generate example dataset
X <- MASS::mvrnorm(n = n, mu = mu, Sigma=Sigma)

GMV_MP_shrinkage_Cent = 
  GMV_Moore_Penrose_target_eq(Y = t(X), centeredCov = TRUE)
  
GMV_MP_shrinkage_Cent_new = 
  GMV_Moore_Penrose_target_general(Y = t(X), centeredCov = TRUE)
  
# This should coincide with GMV_MP_shrinkage_Cent since by default this is
# shrinked to the equally weighted portfolio.

outOfSampleVariance = t(GMV_MP_shrinkage_Cent) \%*\% Sigma \%*\% GMV_MP_shrinkage_Cent

ones = rep(1, length = p)
V_GMV = 1 / ( t(ones) \%*\% solve(Sigma) \%*\% ones)

Loss_GMV_Moore_Penrose_target_eq = (outOfSampleVariance - V_GMV) / V_GMV

GMV_MP_Cent = GMV_Moore_Penrose(Y = t(X), centeredCov = TRUE)
outOfSampleVariance = t(GMV_MP_Cent) \%*\% Sigma \%*\% GMV_MP_Cent

Loss_GMV_Moore_Penrose = (outOfSampleVariance - V_GMV) / V_GMV

# Shrinkage helps to reduce the loss
stopifnot(Loss_GMV_Moore_Penrose_target_eq < Loss_GMV_Moore_Penrose)



}
\references{
Nestor Parolya & Taras Bodnar (2024).
Reviving pseudo-inverses: Asymptotic properties of large dimensional
Moore-Penrose and Ridge-type inverses with applications.
\link{https://doi.org/10.48550/arXiv.2403.15792}
}
