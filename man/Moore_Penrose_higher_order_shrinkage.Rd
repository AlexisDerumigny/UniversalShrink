% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Moore_Penrose_higher_order_shrinkage.R
\name{Moore_Penrose_higher_order_shrinkage}
\alias{Moore_Penrose_higher_order_shrinkage}
\title{Moore-Penrose higher order shrinkage of the precision matrix}
\usage{
Moore_Penrose_higher_order_shrinkage(Y, m, centeredCov)
}
\arguments{
\item{Y}{data matrix (rows are features, columns are observations).
TODO: transpose everything.}

\item{m}{order of the shrinkage. Should be at least 1.}
}
\value{
the estimator of the precision matrix
(a \code{p} by \code{p} matrix, i.e. the inverse of the covariance matrix).
}
\description{
This function compute an estimator of the precision matrix by using the
polynomial
\deqn{\alpha_0 I_p + \sum_{k = 1}^m \alpha_k \left(\widehat{\Sigma^{-1}}^{MP}\right)^k}
where \eqn{\alpha_0, \dots, \alpha_p} are carefully chosen coefficients,
\eqn{\widehat{\Sigma^{-1}}^{MP}} is the Moore-Penrose inverse of the sample
covariance matrix
and \eqn{I_p} is the identity matrix of size \eqn{p}.
}
\examples{

n = 50
p = 2 * n
mu = rep(0, p)

# Generate Sigma
X0 <- MASS::mvrnorm(n = 10*p, mu = mu, Sigma = diag(p))
H <- eigen(t(X0) \%*\% X0)$vectors
Sigma = H \%*\% diag(seq(1, 0.02, length.out = p)) \%*\% t(H)

# Generate example dataset
X <- MASS::mvrnorm(n = n, mu = mu, Sigma=Sigma)

FrobeniusNorm2 <- function(M){sum(diag(M \%*\% t(M)))}

precision_MoorePenrose_Cent = 
  Moore_Penrose_shrinkage(Y = t(X), centeredCov = TRUE)
precision_MoorePenrose_NoCent = 
  Moore_Penrose_shrinkage(Y = t(X), centeredCov = FALSE)
  
FrobeniusLoss2 <- function(M){FrobeniusNorm2(M \%*\% Sigma - diag(p) ) / p}

print(FrobeniusLoss2(precision_MoorePenrose_Cent))
print(FrobeniusLoss2(precision_MoorePenrose_NoCent))

for (m in 1:5){
  cat("m = ", m, "\n")
  precision_higher_order_shrinkage_Cent = 
      Moore_Penrose_higher_order_shrinkage(Y = t(X), m = m, centeredCov = TRUE, t = 10)
      
  precision_higher_order_shrinkage_NoCent = 
      Moore_Penrose_higher_order_shrinkage(Y = t(X), m = m, centeredCov = FALSE, t = 10)
      
  print(FrobeniusLoss2(precision_higher_order_shrinkage_Cent$estimated_precision_matrix))
  
  print(FrobeniusLoss2(precision_higher_order_shrinkage_NoCent$estimated_precision_matrix))
}



}
\references{
Nestor Parolya & Taras Bodnar (2024).
Higher-order nonlinear shrinkage estimator of large-dimensional precision matrix.
}
